{% extends "base_generic.html" %}
{% block content %}
    <div class="row" style="padding: 0 5px">
        <aside class="col-lg-3 left-media-block">
            <strong>Свежак на сайте</strong>
            {% for elem in all_latest %}
            <a href="{% url 'article' section_name=elem.section subsection_name=elem.subsection article_title=elem.title %}" class="row all-top-5">
                <strong>{{ elem.title }}</strong>
            </a>
                <hr>
            {% endfor %}
        </aside>

        <section class="col-lg-6 center-media-block">
            <div>
                {% if last %}
                <a class="row big-ref-article " href="{% url 'article' section_name=last.section subsection_name=last.subsection article_title=last.title %}">
                    <strong class="position-absolute">{{ last.title }}</strong>
                    <img src="{{ last.img_big.url }}" class="img-fluid top-img">
                </a>
                {% endif %}
            </div>
            <div class="row">
                <div class="col-sm-6">
                    {% if top7 %}
                    <a class="row small-ref-article " href="{% url 'article' section_name=top7.section subsection_name=top7.subsection article_title=top7.title %}">
                        <img src="{{ top7.img_small.url }}" class="img-fluid">
                        <strong>{{ top7.title }}</strong>
                    </a>
                    {% endif %}
                </div>
                <div class="col-sm-6">
                    {% if top3 %}
                    <a class="row small-ref-article " href="{% url 'article' section_name=top3.section subsection_name=top3.subsection article_title=top3.title %}">
                        <img src="{{ top3.img_small.url }}" class="img-fluid">
                        <strong>{{ top3.title }}</strong>
                    </a>
                    {% endif %}
                </div>
            </div>
        </section>

        <aside class="col-lg-3 right-media-block">
            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <!-- right side bar -->
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-3308265973976218"
                 data-ad-slot="6905253155"
                 data-ad-format="auto"></ins>
            <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </aside>
    </div>
    <div id="list">
        <div class="row">
            {% include 'article/list_for_section.html' %}
        </div>
    </div>
{% endblock %}
{% block js %}
    {% if obj.has_next %}
        <script>
        var i = {{ obj.next_page_number }};
        $(window).scroll(function() {
            if($(window).scrollTop() + $(window).height() === $(document).height() && i <= {{ max }}) {
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                    if (this.readyState === 4 && this.status === 200) {
                        div = document.createElement('div');
                        test = document.getElementById("list");
                        test.appendChild(div);
                        last_div = document.getElementById("list").lastElementChild;
                        last_div.className = "row";
                        last_div.innerHTML = this.responseText;
                    }
                };
                xhttp.open("GET", "{% url 'section' section_name %}?page=" + i, true);
                i+=1;
                xhttp.send();
            }

        });
        </script>
    {% endif %}
{% endblock %}


